---
layout: post
title:  "Typo"
thumbnail: "template.png"
---
<canvas class="draw-target"></canvas>
<script>
var tileSize = 0.01;
var sides = 3;

var points;
var ymin, ymax;

function init(ctx, w, h) {
    Math.seedrandom('alantessa');
}

function resize(ctx, w, h) {
    var fontSize = (w * 0.2);
    var text = 'Alan&Tessa';

    var offcanvas = document.createElement('canvas');
    offcanvas.width = w;
    offcanvas.height = h;

    var offctx = offcanvas.getContext('2d');
    offctx.font = fontSize + "px Serif";
    offctx.fillStyle = 'red';
    offctx.fillText(text, 0, h * 0.6);

    points = [];

    var pixels = offctx.getImageData(0, 0, w, h).data;
    for(var x = 0; x < 1; x += tileSize) {
        for(var y = 0; y < 1; y += tileSize) {
            if(checkPixel(pixels, Math.floor(x * w), Math.floor(y * h), w)) {
                var color = Math.floor(Math.random() * 256);
                points.push({
                    x: x,
                    y: y,
                    xNoise: (Math.random() - 0.5) * 0.005,
                    yNoise: (Math.random() - 0.5) * 0.005,
                    color: [color, color, color],
                    alpha: 1,
                    rotate: Math.random() * Math.PI * 2,
                    size: Math.random() * 0.8
                });
            } else {
                points.push({
                    x: x,
                    y: y,
                    xNoise: 0,
                    yNoise: 0,
                    color: [0, 0, 0],
                    alpha: 0.2,
                    rotate: 0,
                    size: 0.3
                });
            }
        }
    }
}

function update(ctx, w, h, tick) {
    ctx.clearRect(0, 0, w, h);

    for(var i = 0; i < points.length; i++) {
        var p = points[i];
        var morph = (Math.cos(p.x * Math.PI * 1.5 - tick * 0.1) + 1.0) * 0.5

        polygon(
            ctx,
            p.x * w + (p.xNoise * morph),
            p.y * h + (p.yNoise * morph),
            Math.max(w * tileSize, 5) * Math.max(0.3, (p.size * morph)),
            sides,
            'rgba(' + Math.floor(p.color[0] * morph) + ',' + Math.floor(p.color[1] * morph) + ',' + Math.floor(p.color[2] * morph) + ',' + Math.max(0.2, (p.alpha * morph)) + ')',
            (p.rotate * morph)
        );
    }
}

function checkPixel(pixels, x, y, w) {
    return pixels[(w * y + x) * 4] !== 0;
}

function polygon(ctx, x, y, r, sides, color, rotate) {
    var angle = 2 * Math.PI / sides;
    var initAngle = rotate || (Math.PI / 2);
    if (sides % 2 == 0) {
        initAngle -= (angle / 2);
    }

    ctx.beginPath();
    ctx.moveTo(x + r * Math.cos(initAngle), y - r * Math.sin(initAngle));
    for (var i = 1; i <= sides; i++) {
        var ox = Math.cos(initAngle + (angle * i));
        var oy = Math.sin(initAngle + (angle * i));
        ctx.lineTo(x + r * ox, y - r * oy);
    }
    ctx.fillStyle = color;
    ctx.fill();
}
    
function vivid() {
    while(true) {
        var r = Math.floor(Math.random() * 256);
        var g = Math.floor(Math.random() * 256);
        var b = Math.floor(Math.random() * 256);
        var mu = (r + g + b) / 3;
        var sd = Math.sqrt((Math.pow(mu - r, 2) + Math.pow(mu - g, 2) + Math.pow(mu - b, 2)) / 3);
        if(mu > 150 && sd > 70) return [r, g, b];
    }
}
</script>
